# 예외
예외를 제대로 활용하면 프로그램의 가독성, 신뢰성, 유지보수성이 높아진다.

## 아이템 69 예외는 진짜 예외 상황에만 사용하라
- 예외는 필요한 상황에만 사용해야한다.
```java
try {
    int i = 0;
    while(true)
        range[i++].climb();
} catch (ArrayIndexOutOfBoundsException e)
}
```
예외를 잘못 사용한 예
```java
for (Mountain m : range)
    m.climb();
```
정상적인 코드
- 예외를 쓰지 않아도 되는 제어 흐름의 상황을 예외로 처리하면 성능이 느려지고 최적화가 제한된다.
- 잘 설계된 API라면 클라이언트가 정상적인 제어 흐름에서 예외를 사용할 일이 없게 해야한다.

## 아이템 70 복구할 수 있는 상황에는 검사 예외를, 프로그래밍 오류에는 런타임 예외를 사용하라
- 검사 예외: 컴파일 단계에 컴파일러가 체크, Exception 하위 클래스 중 Runtime 제외한 예외, 처리 안하면 컴파일 에러가 난다.
- 비검사 예외: 실행 단계, 컴파일러에게 안걸러지고 실행했을 때 발생한다.
- 에러: 심각한 수준의 오류이고 어플리케이션에서 제어할 수 없기 때문에, 비검사예외(Unckecked Exception)로 분류한다.
- 호출하는 쪽에서 복구하리라 여겨지는 상황이라면 `검사 예외`를 사용하라. -> API 사용자에게 검사 예외를 주어 그 상황을 회복하라고 요구하는 것이다.
- 프로그래밍 오류를 나타낼 때는 런타임 예외를 사용하라.
- 런타임 예외는 대부분 클라이언트가 해당 API에 명세된 기록인 전제 조건을 위배했을 때 발생한다.
- 우리가 구현하는 비검사 `throwable`은 모두 RuntimeException의 하위 클래스여야한다.
- `Exception, RuntimeException, Error`를 상속하지 않은 throwable은 절대로 사용하지마라.
- 검사 예외는 일반적으로 복구할 수 있는 조건일 때 발생하므로 호출자가 예외 상황에서 벗어나느데 필요한 정보를 알려주는 메서드를 함께 제공해야한다.

## 아이템 71 필요 없는 검사 예외 사용은 피하라
- 검사 예외를 회피하는 가장 쉬운 방법은 적절한 결과 타입을 담은 `옵셔널`을 반환하는 것이다.
- 예외를 사용하면 구체적인 예외 탕비과 그 타입이 제공하는 메서드들을 활용해 부가정보를 제공할 수 있다.
- API 호출자가 예외 상황에서 복구할 방법이 없다면 비검사 예외를 던진다.
- 복구 가능하고 호출자가 그 처리를 해주길 바란다면 옵셔널 반환을 고려한다.
- 옵셔널만으로 충분한 정보 제공이 되지 않을 때만 검사 예외를 던진다.

## 아이템 72 표준 예외를 사용하라
- 표준 예외를 사용하면 우리의 API가 다른 사람이 익히고 사용하기 쉬워지는 예외가 된다.
- `Exception, RuntimeException, Error, Throwable`은 직접 재사용하는 하지 말고 추상 클래스라고 생각해야한다.

## 아이템 73 추상화 수준에 맞는 예외를 던지라
- 상위 계층에서는 저수준 예외를 잡아 자신의 추상화 수준에 맞는 예외로 바꿔 던진다.
- 예외 연쇄: 문제의 근본 원인인 저수준 예외를 고수준 예외에 실어 보내는 방식
- 아래 계층의 예외를 예방하거나 스스로 처리할 수 없고, 그 예외를 상위 계층에 그대로 노출하기 곤란하다면 예외 번역을 사용하라.

## 아이템 74 메서드가 던지는 모든 예외를 문서화하라
- 메서드가 던질 수 있는 예외를 각각 @throws 태그로 문서화하라.
- 검사 예외는 항상 따로 선언하고, 각 예외가 발생하는 상황을 자바독의 @throws 태그를 사용하여 정확히 문서화하라.
- 비검사 예외는 @throws 목록에 넣지 않아서 검사 예외와 구분하라.
- 메서드가 던질 가능성 있는 모든 예외를 문서화 하라.

## 아이템 75 예외의 상세 메시지에 실패 관련 정보를 담으라
- 스택 추적은 예외 객체의 toString 메서드를 호출해 얻는 문자열로, 보통 예외 클래스 이름 뒤에 상세 메시지가 붙는 형태이다.
- 실패 순간을 포착하려면 발생한 예외에 관여된 모든 매개변수와 필드의 값을 실패 메시지에 담아야한다.

## 아이템 76 가능한 한 실패 원자적으로 만들라
- 호출된 메서드가 실패하더라도 해당 객체는 메서드 호출 전 상태를 유지해야하는데 이를 `실패 원자적`이라고 한다.
- 실패 원자적을 만들 수 있는 방법들
  - 불변 객체를 설계
  - 작업 수행에 앞서 매개변수의 유효성을 검사
  - 실패할 가능성이 있는 모든 코드를 객체의 상태를 바꾸는 코드보다 앞에 배치
  - 객체의 임시 복사본에서 작업을 수행한 다음, 작업이 성공적으로 완료되면 교체
  - 작업 도중 발생하는 실패를 가로채는 복구 코드를 작성하여 작업 전 상태로 되돌림
- 메서드 명세에 기술한 예외라면 설혹 예외가 발생하더라도 객체의 상태는 메서드 호출 전과 똑같아야한다.

## 아이템 77 예외를 무시하지 말라
- `catch 블록`을 비워두면 예외가 존재할 이유가 없어진다.
- 예외를 무시하기로 했다면 catch 블록 안에 그렇게 결정한 이유를 주석으로 남기고 예외 변수의 이름도 `ignored`로 비꿔놓자.
