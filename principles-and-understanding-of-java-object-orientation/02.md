# 2장 자바와 절차적/구조적 프로그래밍

## 자바 프로그램의 개발과 구동
- 자바는 객체지향 언어이면서 더 근본적으로는 프로그래밍 언어
- 자바 환경 명칭
  - JDK(Java Develpoment Kit)
  - JRE(Java Runtime Enviroment)
  - JVM(Java Virutual Machine)
- `자바 개발 도구인 JDK를 이용해서 개발된 프로그램은 JRE에 의해 가상의 컴퓨터인 JVM 상에서 구동`
- JDK는 `자바 소스 컴파일러인 javac`를 포함하고 있고, JRE는 자바 프로그램 실행기인 `java`를 포함하고 있음
- 자바 개발자는 보인이 사용 중인 플랫폼에 설치된 JVM 용으로 프로그램을 작성하고 배포하면 각 플랫폼에 맞는 JVM이 중재자로서 각 플랫폼에서 프로그램을 구동
- 자바 메모리 사용 방식
  - 코드 영역
  - 메모리 저장 영역: `스태틱 영역 + 스택 영역 + 힙 영역`


## 자바에 존재하는 절자척/구조적 프로그래밍의 유산
- `절차적 프로그래밍을 한마디로 표현하자면 goto를 쓰지 말라는 것`으로 goto를 사용하지 않으므로서 프로그램의 실행 순서를 인간인 이해하기 편하게 함
- `구조적 프로그래밍은 함수를 쓰라는 것`으로 중복 코드를 한 곳에 모아서 관리하고, 논리를 함수 단위로 분리해서 이해하기 쉬운 코드를 작성하게 함
- 자바 키워드 중 절반 이상이 절차적/ 구조적 프로그래밍 언어에서 유래
- 함수는 클래스나 객체와 아무 관계 없지만, 메서드는 반드시 클래스 정의 안에 존재해야한다는 것


## 다시 보는 main() 메서드: 메서드 스택 프레임
- 자바 프로그램 실행 순서
  - JRE는 먼저 프로그램 안에 main() 메서드가 있는지 확인
  - 가상의 기계인 JVM에 전원을 넣어 부팅
  - 부팅된 JVM은 목적 파일을 받아 그 목적 파일을 실행
  - JVM은 가장 먼저 전처리하고 메모리 영역의 스태틱 영역에 가져다 놓음
- JVM에서 main() 메서드가 실행되기 전 JVM에서 수행하는 전처리 작업
  - java.lang 패키지를 메모리 영역에 스태틱 영역에 배치
  - import 패키지를 메모리 영역에 스태틱 영역에 배치
  - 프로그램 상의 모든 클래스를 메모리 영역의 스태틱 영역에 배치
- 메서드들의 놀이터는 스택로 스택 영역에 메서드 스택 프레임이 잡힘
- `여는 중괄호를 만날 때마다 스택 프레임이 하나씩 생성`
- 여는 중괄호로 스택 프레임이 만들어지고 닫는 중괄호로 스택 프레임이 소멸
- 변수 공간을 확보하는 것은 메서드 인자들의 변수 공간을 할당하는 것
- main() 메서드가 프로그램의 시작점이고 끝이므로 main() 메서드가 끝나면 JRE는 JVM을 종료하고 JRE 자체도 메모리에서 사라짐


## 변수와 메모리: 변수! 너 어디 있니?
- 메서드 스택 프레임 안에 밑에서부터 차곡차곡 변수 공간을 마련
- 초기화 되지 않은 변수는 쓰레기 값이 할당


## 블록 구문과 메모리: 블록 스택 프레임
- 여는 중괄호를 만나면 스택 프레임이 시작된다고 하는데 스택 프레임은 `메서드의 스택 프레임`이 뿐만 아니라 제어문 반복문같은 `블록 스택 프레임`도 존재


## 지역 변수와 메모리: 스택 프레임에 갇혀어요!
- 변수는 `스태틱 영역, 스택 영역, 힙 영역` 모두에 존재하고 각각 `클래스 멤버 변수(스태틱), 지역 변수(스택), 객체 멤버 변수(힙)`
- 클래스 멤버 변수는 스태틱 영역에 존재하며, 고정된 상태로 그 자리에 있음
- 지역 변수는 스택 영역에 존재하며, 스택 프레임 안에서 일생을 보냄
- 객체 멤버 변수는 힙 영역에 존재하며, 가비지 컬렉터가 메모리에서 회수하면 일생을 마침
- 외부 블록에서 내부 블록의 변수에는 접근할 수 없고, `내부 블록에서 외부 블록의 변수에 접근하는 것은 가능`

## 메서드 호출과 메모리: 메서드 스택 프레임 2
- 메서드 호출도 별도의 스택 프레임을 갖기 때문에 다른 스택 스페임의 변수에는 접근이 불가
- 메서드를 호출하면서 인자로 전다되는 것은 변수 자체가 아니라 변수가 저장한 값만을 복제해서 전달하고 이런 방식을 `Call by Value`라고 함
- 자바는 기본이 Call by Value이고, 객체를 넘겨도 객체를 참조하는 지역변수가 가리키고 있는 힙 영역의 객체를 가리키는 값을 넘기므로 Call by Reference는 아님

## 전역 변수와 메모리: 전역 변수 쓰지 말라니까요!
- 전역 변수는 static 키워드를 붙여서 할당하는 변수로 스택 프레임 안에 있지 않아서 스택이 아닌 static 영역에 할당되는 변수
- 전역 변수는 어느 곳에서나 접근할 수 있어서 편해보이지만, 코드가 많아지면 많아질수록 전역 변수에 저장되어 있는 값을 파악하기가 쉽지 않기 때문에 사용을 지양해야함

## 멀티 스레드 / 멀티 프로세스의 이해
- 멀티 프로세스는 다수의 자바 메모리 구조를 갖지만, 멀티 스레드는 하나의 메모리 구조만 갖고 스택 영역만 분할해서 사용
- 멀티 스레드는 스택 영역만 분할한 것이기 때문에 힙 영역과 스태틱 영역은 공유함 -> 전역 변수는 스태틱 영역으로 멀티 스레드에서 조심해서 사용되어야함
